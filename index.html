<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>CRM Zaaz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html, body { height: 100%; margin: 0; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
    header { padding: 12px 16px; border-bottom: 1px solid #e5e7eb; font-weight: 600; }
    .wrap  { height: calc(100% - 50px); }
    iframe { width: 100%; height: 100%; border: 0; display: block; }
    #fallback { display:none; height: 100%; place-items: center; text-align: center; padding: 24px; }
    .btn { display:inline-block; padding:10px 14px; border-radius:8px; border:1px solid #2563eb; color:#2563eb; text-decoration:none; }
    .muted { color:#6b7280; }
  </style>
</head>
<body>
  <header>Hola</header>

  <div class="wrap">
    <!-- IFRAME al estilo Google Sites -->
    https://script.google.com/macros/s/AKfycbxa-v6VBa1Bay24KPft08B9jbvTSrx_DsNYWVvIuhve3Rr_gmVVcTEs6wdfc2eG1qHI/exec
      sandbox="
        allow-forms
        allow-modals
        allow-popups
        allow-popups-to-escape-sandbox
        allow-presentation
        allow-same-origin
        allow-scripts
      "
      allow="
        geolocation *; microphone *; camera *; clipboard-read *; clipboard-write *;
        display-capture *; fullscreen *; payment *
      "
      referrerpolicy="strict-origin-when-cross-origin"
      allowfullscreen
      loading="eager"
    ></iframe>

    <!-- Fallback si el iframe es bloqueado por X-Frame-Options/CSP -->
    <div id="fallback">
      <div>
        <h3>No se pudo mostrar el App Script dentro de esta página</h3>
        <p class="muted">
          Es probable que el servidor del App Script impida la inserción en iframe.
          Puedes abrir el CRM en esta misma pestaña con este botón:
        </p>
        <p><a class="btn" id="openSameTab" href="#">Abrir CRM</a></p>
      </div>
    </div>
  </div>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbxa-v6VBa1Bay24KPft08B9jbvTSrx_DsNYWVvIuhve3Rr_gmVVcTEs6wdfc2eG1qHI/exec";
    const frame   = document.getElementById("appFrame");
    const fallback= document.getElementById("fallback");
    const openBtn = document.getElementById("openSameTab");

    // Si el iframe no carga en ~1.5s, mostramos fallback
    let loaded = false;
    frame.addEventListener("load", () => { loaded = true; }, { once: true });
    setTimeout(() => { if (!loaded) { frame.style.display="none"; fallback.style.display="grid"; } }, 1500);

    // Botón para abrir en la misma pestaña (si el iframe está bloqueado)
    openBtn.addEventListener("click", (e) => { e.preventDefault(); window.location.href = GAS_URL; });
  </script>
</body>
</html>
